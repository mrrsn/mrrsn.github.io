import{formatTime}from"../timer/utils.js";import{getExpectedShots,getTotalSeconds}from"../timer/config.js";export function addShotRow(t,e,o,n,d=null){const s=document.getElementById("shotsTable");let a=s?s.querySelector("tbody"):null;if(s?a||console.debug("addShotRow diagnostic: #shotsTable found but tbody missing. table children=",s.children.length):console.debug("addShotRow diagnostic: #shotsTable not found in DOM. document.readyState=",document.readyState),!s){const t=document.getElementById("shotsPanel");if(t){console.warn("addShotRow: #shotsTable missing — creating placeholder table inside #shotsPanel");const e=document.createElement("table");e.id="shotsTable";const o=document.createElement("thead"),n=document.createElement("tr");["Stage","Time","Δ (ms)","RMS"].forEach(t=>{const e=document.createElement("th");e.textContent=t,n.appendChild(e)}),o.appendChild(n);const d=document.createElement("tbody");e.appendChild(o),e.appendChild(d),t.appendChild(e),a=d}}if(s&&!a&&(a=document.createElement("tbody"),s.appendChild(a)),!a)return void console.warn("addShotRow: #shotsTable tbody not found; cannot append row");const c=document.createElement("tr"),l=formatTime(o),i="number"==typeof e?e.toFixed(1):"",r=("number"==typeof o&&o.toFixed(1),document.createElement("td"));r.textContent=`Shot ${t+1} of ${getExpectedShots()}`,c.appendChild(r);const m=document.createElement("td");m.textContent=l,c.appendChild(m);const h=document.createElement("td");h.textContent=i,c.appendChild(h);const u=document.createElement("td");u.textContent="number"==typeof d?d.toFixed(2):"",c.appendChild(u);try{const t=1e3*getTotalSeconds();"number"==typeof o&&o>t&&(c.classList.add("shot-warning"),c.setAttribute("data-warning","late"),c.setAttribute("title","Late shot"),c.setAttribute("aria-label","Late shot"))}catch(t){}t+1>getExpectedShots()&&(c.classList.add("shot-warning"),c.setAttribute("data-warning","over-count"),c.setAttribute("title","Extra shot (over expected count)"),c.setAttribute("aria-label","Extra shot")),a.appendChild(c);const p=document.getElementById("shotsSummaryCount");p&&(p.textContent=String(a.children.length))}export function clearShotsTable(){const t=document.querySelector("#shotsTable tbody");if(!t)return;for(;t.firstChild;)t.removeChild(t.firstChild);const e=document.getElementById("shotsSummaryCount");e&&(e.textContent="0")}export function setRmsColumnVisible(t){const e=document.getElementById("shotsTable");e&&(t?e.classList.remove("hide-rms"):e.classList.add("hide-rms"))}try{setRmsColumnVisible(!1)}catch(t){}